{"componentChunkName":"component---src-templates-blogs-post-js","path":"/lol-champ-minimap-detection-part-1/","result":{"data":{"site":{"siteMetadata":{"title":"Fabran99"}},"markdownRemark":{"id":"f034b01c-a0e0-58a4-aeaa-714a2a590e7e","excerpt":"Detección de personajes de LOL en tiempo real (Parte 1)  Objetivo Como experimento para familiarizarme con la detección de elementos en…","rawMarkdownBody":"\r\n# Detección de personajes de LOL en tiempo real (Parte 1)\r\n\r\n![](img1.png)\r\n\r\n\r\n## Objetivo\r\nComo experimento para familiarizarme con la detección de elementos en imagenes me di a la tarea de generar algún programa que usando **Machine Learning** (Python y FastAI) detecte los personajes de League of Legends en una imagen del minimapa. **En el siguiente gif se puede ver el resultado final.**\r\n\r\n![](result.gif)\r\n\r\n[En este post](https://medium.com/@farzatv/deepleague-leveraging-computer-vision-and-deep-learning-on-the-league-of-legends-mini-map-giving-d275fd17c4e0) se da una aproximación al problema, que utiliza datos de partidas grabadas para generar el dataset de entrenamiento, lo cual tiene sus problemas, sin embargo **en este caso voy a usar otro método que nos da mucho mas posibilidades.**\r\n\r\n## Generación de dataset\r\n![](img2.PNG)\r\nMi approach para generar el dataset va a ser simplificar el proceso lo más posible y a la vez, obtener un dataset amplio y que no esté limitado a partidas previas o a que personajes son más usados.\r\n\r\nPor lo tanto queremos que:\r\n1. El dataset sea suficientemente grande para que el modelo pueda adecuarse lo suficiente al problema.\r\n2. No limitarnos por los personajes que estén en el meta.\r\n3. Facilidad para ampliar el dataset si sale un campeón nuevo.\r\n\r\nLa solución que desarrollé toma en cuenta esos factores, **generando artificialmente las imagenes** con los personajes en lugares aleatorios del minimapa. \r\nEsto por un lado nos permite generar tantas imagenes como se quiera haciendo que **el dataset sea virtualmente infinito**, sino que solucionamos el problema de obtener los bounds de cada personaje en cada imagen ya que somos nosotros quien los determinamos.\r\n\r\n## Generando las imagenes\r\n![](img3.PNG)\r\nLo primero que hay que hacer es **obtener fondos de minimapa vacios**, que sirvan de base para luego colocar los iconos de los personajes.\r\n\r\nPara esto saqué **una serie de capturas del minimapa** en distintos estados del juego, quitando con photoshop los personajes **de forma que quedaran vacios** (como se ven en la imagen de arriba)\r\n\r\nUna vez tuve unos 20 o 30 fondos, para aumentar la aleatoriedad hice un pequeño script que se encarga de cortar las imagenes en una diagonal, y unir cada trozo con la diagonal opuesta de cada otra imagen, de forma que con n capturas obtenemos n*n imagenes.\r\n\r\n### El proceso se ve mas o menos asi\r\n![](img4.PNG)\r\n1. Tomamos 2 imagenes\r\n2. Las rotamos 45 grados\r\n3. Tomamos la mitad izquierda de la imagen 1 y la mitad derecha de la imagen 2.\r\n4. Unimos las 2 imagenes.\r\n5. Rotamos 45 grados en la dirección opuesta.\r\n6. Cortamos la imagen para que no queden bordes.\r\n\r\nAquí el código utilizado\r\n`embed:blog/lol-champ-minimap-detection-part-1/join_images.py`\r\n\r\nEn este punto tenemos las imagenes del fondo, **faltan los personajes**. Para esto tambien voy a sacar capturas de pantalla y recortar los iconos de los personajes, en este caso tomé unos 15, evitando tomar el borde que señala el equipo, esto lo vamos a añadir luego nosotros.\r\n\r\n![](img5.PNG)\r\n\r\nCon el siguiente script se le agrega el borde a las imagenes de acuerdo al color del team que le corresponda.\r\n`embed:blog/lol-champ-minimap-detection-part-1/champ_icon.py`\r\n![](img6.PNG)\r\n\r\n## Generacion final de las imagenes\r\nLo que vamos a hacer ahora es una función que **genere una imagen aleatoria con 2 equipos** con personajes al azar de los disponibles. A su vez **vamos a obtener los bounds de cada personaje** que no esté tapado por otro.\r\n\r\nPrimero preparo un par de variables y unas funciones de utilidad\r\n`embed:blog/lol-champ-minimap-detection-part-1/generate_images.py{snippet: \"utilities\"}`\r\n\r\n### Genero las imagenes\r\n`embed:blog/lol-champ-minimap-detection-part-1/generate_images.py{snippet: \"generate_images\"}`\r\n\r\n\r\nEjecutando esta funcion en bucle obtenemos imagenes que son indistinguibles de las reales y sirven para entrenar el.\r\n![](img7.PNG)\r\n\r\n\r\n## Conversion de los bounds a annotation\r\nPara entrenar el modelo, ademas de las imagenes **necesitamos una forma de representar los bounds de los personajes**, esto lo vamos a hacer con una función que convierte los bounds a un xml con el formato que necesitamos.\r\n\r\n`embed:blog/lol-champ-minimap-detection-part-1/generate_images.py{snippet: \"bbox_to_annotation\"}`\r\n\r\nLa idea es que cada vez que generemos una imagen, creemos un xml pasandole los bounds a esta funcion y luego lo guardamos en otra carpeta con el mismo nombre que la imagen.\r\n\r\nDe esta forma obtenemos 2 carpetas, **una con las imagenes y otra con los xmls**, es muy importante que **el nombre de las imagenes y los xmls sean iguales** ya que esto permite a FastAI encontrar los xmls y imagenes correspondientes, solo debe cambiar la extensión.\r\n\r\n![](img8.PNG)\r\n\r\n## Conclusion\r\nEn este punto podemos generar tantas imagenes como se quiera para entrenar el modelo, en la siguiente parte vamos a **entrenar el modelo** y verlo en accion.","html":"<h1>Detección de personajes de LOL en tiempo real (Parte 1)</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/179fe712e73ec2f3b74f9af7075b1673/6af66/img1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.70270270270271%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAC5ElEQVQozyWS32/bZBiFI3GJiirWJk2cxHF+ObYTO05iJ64bJ3GakK5p0q2spILtApjQxg2rgCHG2ksQF1ztGmmCUioxIe0CaUIqytpO3V/A+GsevmkXrz69+o5ePTrnRM7Pz5ifX/Dn06f8cnTE0e8n4v2Nv549Y34m/s7O+e/Vv7y8fMHp/DnPLy44Pjnh58eP+fX4mL9PT/lnPufi8pI/njwhEi+mkOLLZNIJkkqSTCaJrKTJK1mUQhG1ZPDDj99jBzWi8SVkKUZaSQmN0AltVpbJFlWx5xhtjokMNpvs3hqLQ1GKmkSrUmA66KCVTTxVo1zSuPftAyxX5+4Xe5TKWQqFFbRCnN2ei++1aLstbKFrrw+ITEd1hh/eIGOayPKyIEoy2RwRBm2qlo0hhPsPHtL1K3x0awel6ZMvytRqKsN+wOZ6SNtbo15rsLElCNPKEu2exYJhkzYruLUs3abN6sCjPV5HU/PcPzhAziXp+BqSZbFUtnEcjY5n0V1r0Z9uYZYNBldHRBKJRUbTVUrVPONeh9u3Z5QEpZJdpqRKFLIS9w8PSctxgtCi0anQNHU+3ttmOA4ol3MYhoIcX6QjaCPRK29j2wYbk5BrOz5Xx30yTlMEFEc3hOnFtCA8FAEkKOXS9MMO13d7fHBtiNt/D0Uv0BT+5ooSQb9HZCW2TLg9485X+7i+zkZYR2/VeUu1iSZj5FMxvhGEiiJjNTw+u/cdo+0OwapNGHosVBosCZ9T0QV6oSDMJSTWJ9uMP71JQU3hdupUbIVkRWe8N0XLS3z58ABNVMOtO+x8vi8Om1QbJdb6LoqWw78+oVnL4wWBCGUlSWBXeX93gm3pqEqMhPQug1Wd2Sxk8co7fC1CyasGVSXPdOsGftunZhQxrTKOqNEnN4eim1EankdEdVr43a7wpku5URd9c6i+HqdBsVLBdBx+evQIJxxQ9dcIRddqrdYbXdMVpHUM2yar6+zszfgfg0OGUgb6gSgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img1\"\n        title=\"img1\"\n        src=\"/static/179fe712e73ec2f3b74f9af7075b1673/fcda8/img1.png\"\n        srcset=\"/static/179fe712e73ec2f3b74f9af7075b1673/12f09/img1.png 148w,\n/static/179fe712e73ec2f3b74f9af7075b1673/e4a3f/img1.png 295w,\n/static/179fe712e73ec2f3b74f9af7075b1673/fcda8/img1.png 590w,\n/static/179fe712e73ec2f3b74f9af7075b1673/6af66/img1.png 640w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Objetivo</h2>\n<p>Como experimento para familiarizarme con la detección de elementos en imagenes me di a la tarea de generar algún programa que usando <strong>Machine Learning</strong> (Python y FastAI) detecte los personajes de League of Legends en una imagen del minimapa. <strong>En el siguiente gif se puede ver el resultado final.</strong></p>\n<p><img src=\"/1f392a9a7bef17963ac296c233c2d97f/result.gif\"></p>\n<p><a href=\"https://medium.com/@farzatv/deepleague-leveraging-computer-vision-and-deep-learning-on-the-league-of-legends-mini-map-giving-d275fd17c4e0\">En este post</a> se da una aproximación al problema, que utiliza datos de partidas grabadas para generar el dataset de entrenamiento, lo cual tiene sus problemas, sin embargo <strong>en este caso voy a usar otro método que nos da mucho mas posibilidades.</strong></p>\n<h2>Generación de dataset</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e51798d1b4d50a58516ec814d464d73f/6295b/img2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.27027027027026%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADqUlEQVQ4yyWT60/aZxTHfy/3amm2OrVqVUpBFBQFL4B3uetEQKQCclHxgooCOrUo3uoSuzZdZpYlS7Y3/efmBe20nYBtPnvmTvLkefI9l+fkfL9HMg50oddr0GgbMXYZWc9kcHpHsYwOYXOZMUdi7L35CbffhdVmor1TS4u2jWgkSiQexdDXgcXRgy0cJXlwhNRqaubb5zLa9Ur0Wg2TwRA9lgEUIsnU34ItEiCxs4+xR4+mXU9vtw6jKOIYHsHlGqVSoUDXqWJqIcbCnijYpFPQrJXT0WekXl6Fe9zN984BZIpqWgY6qFdVsJSep1Wv5Ul1GUZHPxVPv8FiH2TA3MfXj75Ca9CiVNczFRlHyuZy5LIrOFwOfKEAR8f75HZ22T/OMT7pwerz8PaXN6wklohFQkwGvHgjQeHfZTO9TmhijAkR55j0c/zuBIm/b7gr3lMqlbj79IkHu7mhUPoPu6dYLP6P3d5SKhQpff78EPtgHz9S/KfAncALIveL8EmeoJfwjJ/QbIhYdp/Xp6ckkvN43A6GRx047Q729g9Jbq7iHLGIY8PhGCaTWSf7aofwXIC5pRjhjS1enf6KVCmroKy2Fl27Cld8lujyKnoxkwq5jGe131FXWYbP58fmtvKo/inPlTWolXIGB80E4y+oUitoa1djDk8S2NhGatM1ItfIMQ4Z6RnUE5uPMWTrFjJSYhFYedVjMSMfdns/jRolnhcj1NQ9pm+ol8hsEIW6gV57Nw2qSgLTfqTZ+CLLm0nCIT8T8RmyBy9ZTaVIv0wTDU/QP+JkYyNN6uiYeGYZ15gdk93G6lqC3bfvWNxO4fFY6HXa2D7KIhXPzshffeDi/IL8xbkgoUDp7JzL/DV/iTt/eUFBEFO8zIv3lcDzXH+4pvRFkHNxyZWIy19dcX1zS+H+HimRTrCRTZESHa39+Jrf/vyDnJBEejtJRmCJ/SN+f//+QUYpEbu8tsj8wgKHB4ec/HxCMjnHzNw0U8EAh4I8SdGmpExeS1dXE96FJYJLq1jcFsrVKnT6RgbFisW2cgy7BjG0ttCkrcMqtOcNxZiI+alokCOrf4KivgqrxYqk61LR1tfJpH+YAUHK/OoiY2ImaqMBqxCsqqmGta01vP4RWg0tGMwm9J0anGMjgpRpKuXVTITGMJm0D5KSzNEo41GP2OMGnhl0zK3E8S+vYPc7UQs5yDr1LGcSBNfSuGM+Gptl1LY04wu6iaz/ID4dxdDbRnmDkinR8b8KFGhxjfNquAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img2\"\n        title=\"img2\"\n        src=\"/static/e51798d1b4d50a58516ec814d464d73f/fcda8/img2.png\"\n        srcset=\"/static/e51798d1b4d50a58516ec814d464d73f/12f09/img2.png 148w,\n/static/e51798d1b4d50a58516ec814d464d73f/e4a3f/img2.png 295w,\n/static/e51798d1b4d50a58516ec814d464d73f/fcda8/img2.png 590w,\n/static/e51798d1b4d50a58516ec814d464d73f/efc66/img2.png 885w,\n/static/e51798d1b4d50a58516ec814d464d73f/6295b/img2.png 919w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nMi approach para generar el dataset va a ser simplificar el proceso lo más posible y a la vez, obtener un dataset amplio y que no esté limitado a partidas previas o a que personajes son más usados.</p>\n<p>Por lo tanto queremos que:</p>\n<ol>\n<li>El dataset sea suficientemente grande para que el modelo pueda adecuarse lo suficiente al problema.</li>\n<li>No limitarnos por los personajes que estén en el meta.</li>\n<li>Facilidad para ampliar el dataset si sale un campeón nuevo.</li>\n</ol>\n<p>La solución que desarrollé toma en cuenta esos factores, <strong>generando artificialmente las imagenes</strong> con los personajes en lugares aleatorios del minimapa.\nEsto por un lado nos permite generar tantas imagenes como se quiera haciendo que <strong>el dataset sea virtualmente infinito</strong>, sino que solucionamos el problema de obtener los bounds de cada personaje en cada imagen ya que somos nosotros quien los determinamos.</p>\n<h2>Generando las imagenes</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4913652cf6d370008bbcde3944fc8303/4dba2/img3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.21621621621622%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACRUlEQVQozx2R20/SARiGuXBrs6lpeAAq8YCi4iEklIP446AoqbVZqZSjg4qVtvTCG1kuQEU8wMwSZ3koHU6xSNPuumrddbjQv+fpp7fPnn3vt/eVRGIxDA0GWttaaRBshOYWiSd2aL/txNXWjNVqZToU5tv3Q2xOgbZ2J4LIwjOzHBwf4OpoOmfNTifDQ8NIfIEJLkgzKFBdQ5GTweDQCJG3EfLKlChVV5Flp/O4r5/tnY9kKvO4UignT2Rer5eN7Q3SFJcpqihEXSzHIghIJhdmKb9eTK1FT5ZMyovRUZZWY1TeUNPY4SBTLsU7+ISdz3todKXoG/Wk5WTyfMjLbnKPkqoC7J0tFGmKcd10IJlYWqW+q4tK8Wjq2Tf9fUQ349T1uNFoVWSLyf0DHtYSSercvdTo1WQpc+kbeMj6/le0d7up1JWQJ3r2FiuS5I+fjE4u4Jue4eW4j/fxfX79/kMwushsdJ5AyM9uYo+/JycEom8IiywYCpyzf6en+CNn3hyT4SmWlt8hWVlbwWw1iEWbMRgbiIjCxqd16k067A4LJqOJYHCKg6MkQrNZHMmEwWAkNBUikUxQW1eDo6kRm83GU+8zJMGZ16RI0ymtKkKaeUHsZojo0jwXZVmU1qgoyM/C3dvLVnyT1HwZpboK8hXpeDwecZQ1Ui6lkquUo5BnYDAZkSx/iCE4jXQP3KdMW4Hf/4rN+BZN7QKdj+6h1moYGxsheXyI3WWh2/uAcn01474xvhwdILSYudXTTrWhli73Hf4DPg9Le6v0YDsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img3\"\n        title=\"img3\"\n        src=\"/static/4913652cf6d370008bbcde3944fc8303/fcda8/img3.png\"\n        srcset=\"/static/4913652cf6d370008bbcde3944fc8303/12f09/img3.png 148w,\n/static/4913652cf6d370008bbcde3944fc8303/e4a3f/img3.png 295w,\n/static/4913652cf6d370008bbcde3944fc8303/fcda8/img3.png 590w,\n/static/4913652cf6d370008bbcde3944fc8303/efc66/img3.png 885w,\n/static/4913652cf6d370008bbcde3944fc8303/4dba2/img3.png 1151w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\nLo primero que hay que hacer es <strong>obtener fondos de minimapa vacios</strong>, que sirvan de base para luego colocar los iconos de los personajes.</p>\n<p>Para esto saqué <strong>una serie de capturas del minimapa</strong> en distintos estados del juego, quitando con photoshop los personajes <strong>de forma que quedaran vacios</strong> (como se ven en la imagen de arriba)</p>\n<p>Una vez tuve unos 20 o 30 fondos, para aumentar la aleatoriedad hice un pequeño script que se encarga de cortar las imagenes en una diagonal, y unir cada trozo con la diagonal opuesta de cada otra imagen, de forma que con n capturas obtenemos n*n imagenes.</p>\n<h3>El proceso se ve mas o menos asi</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f07a68ae274b6fe9a901c2e0080dda3c/1fbe8/img4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADO0lEQVQ4y3WTzW8bVRTFJ3Fw0jj+wontOPHYnhnPh2cy8cTpOB927NhxQuKoTUtNI5KGqCKoEhskFnTFChaAQAKJPY3YQoCqqihikQXtnrAByoIu6R/x4zGsO9LT3POu7tG7954j8YLv/PyckZERIpEoRa1Abnaa0fAoxUKBer3O2NgY0Vgc3dZITaYIh8N4nof09K+nXFxc8Psff/L8+T9c/PYrfz97xr3TUyRJYjKdwFx0mClMIw1JRONxLMsKcoXyLO5KlUrVCHCpVELq9XtkcinWVlf59IvPMKs6pqHSEHjWdunsbVFyTRSzhKLkKWSmmVNV9EaTdn+NGUPDntfJF2UqFRvpysGAbHkG0zH48JOPqHWWyOgyB4L06LVbbJ3cxvMtNHFnzFVozspcVVR679yl9+o2FU8TjzDY2ruG79eR3v/8S15/84ij24d8/c0ZJ+/d5fjOEQeD64yGXsJbmkN1DWRTI51OMjk5RaWsM56IUW+4yJbCykadXCaJVlKQXrSUX548DuYSHg1TdlQxlnSAk8kktuMEcSKVYN6vIOtFhgTu6zrSTz//yHf37/PDgwd8L/7fnp3x8NEjvrp3iiMKq9UqVW+BhVoN27Zpt9sMBgNM0xTHwq3Oi/ladIpF3m40kKKTUewFldqqQ3IqgqyVuex6NLs9LglphEIhhoeHGR4aCl41lcvR6nSC+FJkHLdmkizkcASuZzJI3pKDtlgjr+qU1Qw7h/vs7R/Q3twKiuIvx0VuFlkpEZuIYiQTrPs+w6GhoN2S67DgixGEQ8RTKUFYtzBshazQlulqAWltbZ6T61dZFoTZQhZn0eZyy6dSkjkeH+d4fZ32G2+xcaOPJTasOxrN9jqWIfTpd1fxmx79vVX0RZdYXmbnRpvDmwPSgtBcXmFjsIvhGWTlDBOJJK3eJt72Lt0rHfJiIXbNorXZRVE1QXjtJocffMxyty6EmyFnGyL22djdDlqOZWfIlYW9puL/bzmRYFlY779Y0fOUPYul9UUxAuGiaAypuX+LzTvvCkfs0BCJVm8Z1VDovrIjdJcmGokwIdqMCd9OiFjTNPq7u6I4Kjw8JVxikS/kRS4abP5fhGK+Skn7FBoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img4\"\n        title=\"img4\"\n        src=\"/static/f07a68ae274b6fe9a901c2e0080dda3c/fcda8/img4.png\"\n        srcset=\"/static/f07a68ae274b6fe9a901c2e0080dda3c/12f09/img4.png 148w,\n/static/f07a68ae274b6fe9a901c2e0080dda3c/e4a3f/img4.png 295w,\n/static/f07a68ae274b6fe9a901c2e0080dda3c/fcda8/img4.png 590w,\n/static/f07a68ae274b6fe9a901c2e0080dda3c/1fbe8/img4.png 757w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol>\n<li>Tomamos 2 imagenes</li>\n<li>Las rotamos 45 grados</li>\n<li>Tomamos la mitad izquierda de la imagen 1 y la mitad derecha de la imagen 2.</li>\n<li>Unimos las 2 imagenes.</li>\n<li>Rotamos 45 grados en la dirección opuesta.</li>\n<li>Cortamos la imagen para que no queden bordes.</li>\n</ol>\n<p>Aquí el código utilizado\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\r\n\r\n\r\n<span class=\"token keyword\">def</span> <span class=\"token function\">join_images</span><span class=\"token punctuation\">(</span>img1_route<span class=\"token punctuation\">,</span> img2_route<span class=\"token punctuation\">,</span> new_img_route<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    img1 <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>img1_route<span class=\"token punctuation\">)</span>\r\n    img2 <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>img2_route<span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># rotate imgs 45 degrees without loosing the size</span>\r\n    img1 <span class=\"token operator\">=</span> img1<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> expand<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\r\n    img2 <span class=\"token operator\">=</span> img2<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> expand<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># take the half left of the first and the half right of the second</span>\r\n    img1_half <span class=\"token operator\">=</span> img1<span class=\"token punctuation\">.</span>crop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">.</span>width<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    img2_half <span class=\"token operator\">=</span> img2<span class=\"token punctuation\">.</span>crop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>img2<span class=\"token punctuation\">.</span>width<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> img2<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> img2<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># join the two images</span>\r\n    img_joined <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'RGB'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>img1<span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">,</span> img1<span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    img_joined<span class=\"token punctuation\">.</span>paste<span class=\"token punctuation\">(</span>img1_half<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    img_joined<span class=\"token punctuation\">.</span>paste<span class=\"token punctuation\">(</span>img2_half<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>img1<span class=\"token punctuation\">.</span>width<span class=\"token operator\">//</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># rotate the image back to 0 degrees</span>\r\n    img_joined <span class=\"token operator\">=</span> img_joined<span class=\"token punctuation\">.</span>rotate<span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token punctuation\">,</span> expand<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># crop the image so it only has the center</span>\r\n    img_joined <span class=\"token operator\">=</span> img_joined<span class=\"token punctuation\">.</span>crop<span class=\"token punctuation\">(</span>\r\n        <span class=\"token punctuation\">(</span>img_joined<span class=\"token punctuation\">.</span>width<span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> img_joined<span class=\"token punctuation\">.</span>height<span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> img_joined<span class=\"token punctuation\">.</span>width<span class=\"token operator\">*</span><span class=\"token number\">3</span><span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> img_joined<span class=\"token punctuation\">.</span>height<span class=\"token operator\">*</span><span class=\"token number\">3</span><span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># save image</span>\r\n    img_joined<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>new_img_route<span class=\"token punctuation\">)</span></code></pre></div></p>\n<p>En este punto tenemos las imagenes del fondo, <strong>faltan los personajes</strong>. Para esto tambien voy a sacar capturas de pantalla y recortar los iconos de los personajes, en este caso tomé unos 15, evitando tomar el borde que señala el equipo, esto lo vamos a añadir luego nosotros.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 574px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ce2754d12aa30df0da050cb454a7f600/86389/img5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 27.7027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABIUlEQVQY01WQ7U+CUBTG+f//iz5Xm9lmbbUl5gJBNCFKUF6KeJGXDMYUJXjSi3HX8+Xcc/bb85xzGWE4hW06+FO+zcDyD+Rd1TWpL4qPdL1pmTQJoU8apq4qUi15hiyJwHDDEbS53sJB4IETnrD++j5NKgijN9iW2zIr34fEDVDs9qTP0gyKOMb7cgmGZx9haNQwDmNIA7ax+mnSZ/0+XGNJr4hcqPedfxtenp1jrqhg5MkzzAWFwzDEVBijKArSl2UJTVHgOQ5OP4B4FUCVRGy2DVMdTCe8CNuwwHRvu5BVmRoGMa4vbo7ZBDyK7V1Bf1Vb5sPx0OndNRvWlDtWxrIsfB7Si2JHhkmSQNcWyPO8NbANE77rtX0URljolKlB9Qt8hcKlccfHgQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img5\"\n        title=\"img5\"\n        src=\"/static/ce2754d12aa30df0da050cb454a7f600/86389/img5.png\"\n        srcset=\"/static/ce2754d12aa30df0da050cb454a7f600/12f09/img5.png 148w,\n/static/ce2754d12aa30df0da050cb454a7f600/e4a3f/img5.png 295w,\n/static/ce2754d12aa30df0da050cb454a7f600/86389/img5.png 574w\"\n        sizes=\"(max-width: 574px) 100vw, 574px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Con el siguiente script se le agrega el borde a las imagenes de acuerdo al color del team que le corresponda.\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image<span class=\"token punctuation\">,</span> ImageDraw\r\nbase_folder <span class=\"token operator\">=</span> <span class=\"token string\">\"./images/\"</span>\r\nblue_team_imgs <span class=\"token operator\">=</span> <span class=\"token string\">\"./images/blue_team/\"</span>\r\nred_team_imgs <span class=\"token operator\">=</span> <span class=\"token string\">\"./images/red_team/\"</span>\r\n\r\nchamps <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"zilean\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"...resto de personajes\"</span><span class=\"token punctuation\">]</span>\r\n\r\n<span class=\"token keyword\">for</span> champ_name <span class=\"token keyword\">in</span> champs<span class=\"token punctuation\">:</span>\r\n    <span class=\"token comment\"># Obtengo la imagen</span>\r\n    champ_name <span class=\"token operator\">=</span> champ_name<span class=\"token punctuation\">.</span>lower<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    img <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>base_folder<span class=\"token operator\">+</span><span class=\"token string\">\"champ_icons/\"</span><span class=\"token operator\">+</span>champ_name<span class=\"token operator\">+</span><span class=\"token string\">\".png\"</span><span class=\"token punctuation\">)</span>\r\n    w<span class=\"token punctuation\">,</span> h <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>size\r\n    zoom <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\r\n    zoom2 <span class=\"token operator\">=</span> zoom <span class=\"token operator\">*</span> <span class=\"token number\">1.8</span>\r\n    x <span class=\"token operator\">=</span> w<span class=\"token operator\">/</span><span class=\"token number\">2</span>\r\n    y <span class=\"token operator\">=</span> h<span class=\"token operator\">/</span><span class=\"token number\">2</span>\r\n\r\n    img <span class=\"token operator\">=</span> img<span class=\"token punctuation\">.</span>crop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">-</span> w <span class=\"token operator\">/</span> zoom2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> y <span class=\"token operator\">-</span> h <span class=\"token operator\">/</span> zoom2<span class=\"token punctuation\">,</span>\r\n                    x <span class=\"token operator\">+</span> w <span class=\"token operator\">/</span> zoom2<span class=\"token punctuation\">,</span> y <span class=\"token operator\">+</span> h <span class=\"token operator\">/</span> zoom2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n    offset <span class=\"token operator\">=</span> <span class=\"token number\">2</span>\r\n\r\n    <span class=\"token comment\"># Agrego el borde rojo</span>\r\n    mask <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'L'</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    draw <span class=\"token operator\">=</span> ImageDraw<span class=\"token punctuation\">.</span>Draw<span class=\"token punctuation\">(</span>mask<span class=\"token punctuation\">)</span>\r\n    draw<span class=\"token punctuation\">.</span>ellipse<span class=\"token punctuation\">(</span>\r\n        <span class=\"token punctuation\">(</span>offset<span class=\"token punctuation\">,</span> offset<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>offset<span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> fill<span class=\"token operator\">=</span><span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\r\n    back <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'RGBA'</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    draw2 <span class=\"token operator\">=</span> ImageDraw<span class=\"token punctuation\">.</span>Draw<span class=\"token punctuation\">(</span>back<span class=\"token punctuation\">)</span>\r\n    draw2<span class=\"token punctuation\">.</span>ellipse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n                  fill<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> outline<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">232</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n    img<span class=\"token punctuation\">.</span>putalpha<span class=\"token punctuation\">(</span>mask<span class=\"token punctuation\">)</span>\r\n    img<span class=\"token punctuation\">.</span>paste<span class=\"token punctuation\">(</span>back<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> back<span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># Guardo con el borde rojo</span>\r\n    img<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>red_team_imgs<span class=\"token operator\">+</span>champ_name<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\".png\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># Agrego el borde azul</span>\r\n    draw2<span class=\"token punctuation\">.</span>ellipse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span> img<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n                  fill<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> outline<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">153</span><span class=\"token punctuation\">,</span> <span class=\"token number\">210</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n    img<span class=\"token punctuation\">.</span>paste<span class=\"token punctuation\">(</span>back<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> back<span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># Guardo con el borde azul</span>\r\n    img<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span>blue_team_imgs<span class=\"token operator\">+</span>champ_name<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\".png\"</span><span class=\"token punctuation\">)</span></code></pre></div>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8afe2d80044d0d3faf4f3763a5fef776/fdaf8/img6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.756756756756754%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABy0lEQVQY0x3QwUuTAQCG8S+75T9gRIdGBpF1COpgWQTu4oxYhFi5cCAMRYglFuScYLpYFmnbsOma22hjbq50ksMsyi3R2VyusIIiFxsN/CIbumjaesrvPT6/2yvwf7nUN2LuKdw3PUy5Jij8XOXvFvzOM2Ey09vYwKS1l8ziAvwpbAlfo3Fs6ovEOpT8mHGSXxGlLuRFkX69kxqVh77BNzywz/BudFrCiM3E7Qv7MZ8vIdRVwfRAK8noHOvpDG2nKhhqVOKv38OXoIqloI/N7BrCY/scVWeMqOvuMmqPk36/RsC3hDi/yA1VNc6mMjKmUrK23VjqSvHd6SRiDdDf0sP3jyJvrUb8DQcwqKpIPH+FoGsaYdsOPU+HPrCeLLAcSdGh9TDvHaNZcYLyYoFg20nifXJO7yzCYbiO62oP7bUWAvdj5OKfmPU+QSkr4aUviBAOvGZ78QDyY2GGdc94ZF1AcVRL9nMSh66FvUUCl+UyBq9Vo9fUkAiNE/WPc3bXIaKdWlbGLBivdFNbVs6vVBqBzQ1cXQ/ZJ9NSeeQeBo2DF+6Q9GEuuUy7+hKKwwfpbtUQ9jrZWM1KNnnLjKtewXDzOTTHK0mMBKX+D75FVWiibGCIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img6\"\n        title=\"img6\"\n        src=\"/static/8afe2d80044d0d3faf4f3763a5fef776/fcda8/img6.png\"\n        srcset=\"/static/8afe2d80044d0d3faf4f3763a5fef776/12f09/img6.png 148w,\n/static/8afe2d80044d0d3faf4f3763a5fef776/e4a3f/img6.png 295w,\n/static/8afe2d80044d0d3faf4f3763a5fef776/fcda8/img6.png 590w,\n/static/8afe2d80044d0d3faf4f3763a5fef776/fdaf8/img6.png 674w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Generacion final de las imagenes</h2>\n<p>Lo que vamos a hacer ahora es una función que <strong>genere una imagen aleatoria con 2 equipos</strong> con personajes al azar de los disponibles. A su vez <strong>vamos a obtener los bounds de cada personaje</strong> que no esté tapado por otro.</p>\n<p>Primero preparo un par de variables y unas funciones de utilidad\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\nimg_route <span class=\"token operator\">=</span> base_folder<span class=\"token operator\">+</span><span class=\"token string\">\"imgs/\"</span>\r\nminimaps_route <span class=\"token operator\">=</span> base_folder<span class=\"token operator\">+</span><span class=\"token string\">\"all_minimaps/\"</span>\r\n<span class=\"token comment\"># Genero una lista de todas las imagenes de minimapas para acceder rapidamente</span>\r\nmap_imgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span>minimaps_route<span class=\"token operator\">+</span>x<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>minimaps_route<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">]</span>\r\n\r\n<span class=\"token comment\"># Genero un dataframe con los nombres de los champs</span>\r\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"zilean\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"...resto de champs\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n\r\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_teams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token triple-quoted-string string\">\"\"\"\r\n    Retorna las imagenes y nombres de personajes de cada equipo\r\n    \"\"\"</span>\r\n    <span class=\"token comment\"># Armo 2 equipos al azar</span>\r\n    t1 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span>unique<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    t2 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>sample<span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">.</span>unique<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    t1_imgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n    t2_imgs <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n\r\n    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> t1<span class=\"token punctuation\">:</span>\r\n        img <span class=\"token operator\">=</span> get_champ_img<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token string\">\"red\"</span><span class=\"token punctuation\">)</span>\r\n        t1_imgs<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> t2<span class=\"token punctuation\">:</span>\r\n        img <span class=\"token operator\">=</span> get_champ_img<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">)</span>\r\n        t2_imgs<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token keyword\">return</span> t1_imgs<span class=\"token punctuation\">,</span> t2_imgs<span class=\"token punctuation\">,</span> t1<span class=\"token punctuation\">,</span> t2\r\n\r\n\r\n<span class=\"token keyword\">def</span> <span class=\"token function\">parse_extent</span><span class=\"token punctuation\">(</span>extent<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token triple-quoted-string string\">\"\"\"\r\n    Convierte los bounds de coordenadas a la posicion en pixeles\r\n    \"\"\"</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>extent<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>extent<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>extent<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token operator\">-</span>extent<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\r\n\r\n\r\n<span class=\"token keyword\">def</span> <span class=\"token function\">get_random_img_name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>uuid<span class=\"token punctuation\">.</span>uuid4<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\".png\"</span>\r\n\r</code></pre></div></p>\n<h3>Genero las imagenes</h3>\n<p><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token keyword\">def</span> <span class=\"token function\">draw_teams</span><span class=\"token punctuation\">(</span>width<span class=\"token operator\">=</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span> height<span class=\"token operator\">=</span><span class=\"token number\">250</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token triple-quoted-string string\">\"\"\"\r\n    Genera una imagen al azar\r\n    \"\"\"</span>\r\n    xmin <span class=\"token operator\">=</span> <span class=\"token number\">0.035</span>\r\n    xmax <span class=\"token operator\">=</span> <span class=\"token number\">0.80</span>\r\n    ymin <span class=\"token operator\">=</span> <span class=\"token number\">0.035</span>\r\n    ymax <span class=\"token operator\">=</span> <span class=\"token number\">0.80</span>\r\n    img_size <span class=\"token operator\">=</span> <span class=\"token number\">0.092</span>\r\n    DPI <span class=\"token operator\">=</span> <span class=\"token number\">100</span>\r\n\r\n    fig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>width<span class=\"token operator\">/</span>DPI<span class=\"token punctuation\">,</span> height<span class=\"token operator\">/</span>DPI<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span>DPI<span class=\"token punctuation\">)</span>\r\n    ax <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n    map_img <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>map_imgs<span class=\"token punctuation\">)</span>\r\n\r\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>map_img<span class=\"token punctuation\">,</span> extent<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># Obtengo los teams aleatoriamente</span>\r\n    t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">,</span> t1_names<span class=\"token punctuation\">,</span> t2_names <span class=\"token operator\">=</span> get_teams<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    boundary_boxes <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\r\n    current_zorder <span class=\"token operator\">=</span> <span class=\"token number\">50</span>\r\n    current_positions <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n\r\n    <span class=\"token comment\"># Elijo si mostrar o no el rectangulo de la vision</span>\r\n    <span class=\"token keyword\">if</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.97</span><span class=\"token punctuation\">:</span>\r\n        x <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>xmin<span class=\"token punctuation\">,</span> xmax<span class=\"token punctuation\">)</span>\r\n        y <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>ymin<span class=\"token punctuation\">,</span> ymax<span class=\"token punctuation\">)</span>\r\n        rect <span class=\"token operator\">=</span> patches<span class=\"token punctuation\">.</span>Rectangle<span class=\"token punctuation\">(</span>\r\n            <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token number\">0.32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.17</span><span class=\"token punctuation\">,</span> linewidth<span class=\"token operator\">=</span><span class=\"token number\">1.2</span><span class=\"token punctuation\">,</span> edgecolor<span class=\"token operator\">=</span><span class=\"token string\">'white'</span><span class=\"token punctuation\">,</span> facecolor<span class=\"token operator\">=</span><span class=\"token string\">'none'</span><span class=\"token punctuation\">,</span> zorder<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\r\n\r\n        ax<span class=\"token punctuation\">.</span>add_patch<span class=\"token punctuation\">(</span>rect<span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># Elijo si mostrar o no el personaje</span>\r\n    <span class=\"token keyword\">for</span> t1_img<span class=\"token punctuation\">,</span> t1_name <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>t1<span class=\"token punctuation\">,</span> t1_names<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token keyword\">if</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">continue</span>\r\n        current_zorder <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\r\n        <span class=\"token comment\"># Decido la posicion aleatoriamente</span>\r\n        current_x <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>xmin<span class=\"token punctuation\">,</span> xmax<span class=\"token punctuation\">)</span>\r\n        current_y <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>ymin<span class=\"token punctuation\">,</span> ymax<span class=\"token punctuation\">)</span>\r\n        <span class=\"token comment\"># Reviso si esta muy pegado a otro personaje, en ese caso no lo agrego a los bounds</span>\r\n        <span class=\"token comment\"># porque considero que esta tapado</span>\r\n        should_add <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\r\n        <span class=\"token keyword\">for</span> pos <span class=\"token keyword\">in</span> current_positions<span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>current_x<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.05</span> <span class=\"token keyword\">and</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>current_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.05</span><span class=\"token punctuation\">:</span>\r\n                should_add <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\r\n                <span class=\"token keyword\">break</span>\r\n\r\n        current_positions<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">:</span> current_x<span class=\"token punctuation\">,</span> <span class=\"token string\">\"y\"</span><span class=\"token punctuation\">:</span> current_y<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n        current_extent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>current_x<span class=\"token punctuation\">,</span> current_x <span class=\"token operator\">+</span>\r\n                          img_size<span class=\"token punctuation\">,</span> current_y<span class=\"token punctuation\">,</span> current_y<span class=\"token operator\">+</span>img_size<span class=\"token punctuation\">]</span>\r\n\r\n        <span class=\"token keyword\">if</span> should_add<span class=\"token punctuation\">:</span>\r\n            <span class=\"token comment\"># Agrego los bounds que ingrese</span>\r\n            boundary_boxes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>\r\n                parse_extent<span class=\"token punctuation\">(</span>current_extent<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n            boundary_boxes<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t1_name<span class=\"token punctuation\">)</span>\r\n        <span class=\"token comment\"># Agrego la imagen del personaje al mapa</span>\r\n        plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>t1_img<span class=\"token punctuation\">,</span> extent<span class=\"token operator\">=</span>current_extent<span class=\"token punctuation\">,</span> zorder<span class=\"token operator\">=</span>current_zorder<span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># Elijo si mostrar o no el personaje</span>\r\n    <span class=\"token keyword\">for</span> t2_img<span class=\"token punctuation\">,</span> t2_name <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>t2<span class=\"token punctuation\">,</span> t2_names<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n        <span class=\"token keyword\">if</span> random<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.2</span><span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">continue</span>\r\n        current_zorder <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\r\n        <span class=\"token comment\"># Decido la posicion aleatoriamente</span>\r\n        current_x <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>xmin<span class=\"token punctuation\">,</span> xmax<span class=\"token punctuation\">)</span>\r\n        current_y <span class=\"token operator\">=</span> random<span class=\"token punctuation\">.</span>uniform<span class=\"token punctuation\">(</span>ymin<span class=\"token punctuation\">,</span> ymax<span class=\"token punctuation\">)</span>\r\n        <span class=\"token comment\"># Reviso si esta muy pegado a otro personaje, en ese caso no lo agrego a los bounds</span>\r\n        <span class=\"token comment\"># porque considero que esta tapado</span>\r\n        should_add <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>\r\n        <span class=\"token keyword\">for</span> pos <span class=\"token keyword\">in</span> current_positions<span class=\"token punctuation\">:</span>\r\n            <span class=\"token keyword\">if</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">[</span><span class=\"token string\">'x'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>current_x<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.05</span> <span class=\"token keyword\">and</span> <span class=\"token builtin\">abs</span><span class=\"token punctuation\">(</span>pos<span class=\"token punctuation\">[</span><span class=\"token string\">'y'</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span>current_y<span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;</span> <span class=\"token number\">0.05</span><span class=\"token punctuation\">:</span>\r\n                should_add <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\r\n                <span class=\"token keyword\">break</span>\r\n\r\n        current_positions<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"x\"</span><span class=\"token punctuation\">:</span> current_x<span class=\"token punctuation\">,</span> <span class=\"token string\">\"y\"</span><span class=\"token punctuation\">:</span> current_y<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n        current_extent <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>current_x<span class=\"token punctuation\">,</span> current_x <span class=\"token operator\">+</span>\r\n                          img_size<span class=\"token punctuation\">,</span> current_y<span class=\"token punctuation\">,</span> current_y<span class=\"token operator\">+</span>img_size<span class=\"token punctuation\">]</span>\r\n\r\n        <span class=\"token keyword\">if</span> should_add<span class=\"token punctuation\">:</span>\r\n            <span class=\"token comment\"># Agrego los bounds que ingrese</span>\r\n            boundary_boxes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>\r\n                parse_extent<span class=\"token punctuation\">(</span>current_extent<span class=\"token punctuation\">,</span> width<span class=\"token punctuation\">,</span> height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n            boundary_boxes<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>t2_name<span class=\"token punctuation\">)</span>\r\n        <span class=\"token comment\"># Agrego la imagen del personaje al mapa</span>\r\n        plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>t2_img<span class=\"token punctuation\">,</span> extent<span class=\"token operator\">=</span>current_extent<span class=\"token punctuation\">,</span> zorder<span class=\"token operator\">=</span>current_zorder<span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token comment\"># Quito los bordes</span>\r\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_axis_off<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>subplots_adjust<span class=\"token punctuation\">(</span>top<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> bottom<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> right<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> left<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n                        hspace<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> wspace<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>margins<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>xaxis<span class=\"token punctuation\">.</span>set_major_locator<span class=\"token punctuation\">(</span>plt<span class=\"token punctuation\">.</span>NullLocator<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>gca<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>set_major_locator<span class=\"token punctuation\">(</span>plt<span class=\"token punctuation\">.</span>NullLocator<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n    img_name <span class=\"token operator\">=</span> get_random_img_name<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\"># plt.show()</span>\r\n    plt<span class=\"token punctuation\">.</span>savefig<span class=\"token punctuation\">(</span>img_route <span class=\"token operator\">+</span> img_name<span class=\"token punctuation\">,</span> bbox_inches<span class=\"token operator\">=</span><span class=\"token string\">\"tight\"</span><span class=\"token punctuation\">,</span> pad_inches<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>clf<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    plt<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span>fig<span class=\"token operator\">=</span>fig<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">return</span> boundary_boxes<span class=\"token punctuation\">,</span> img_name\r\n\r</code></pre></div></p>\n<p>Ejecutando esta funcion en bucle obtenemos imagenes que son indistinguibles de las reales y sirven para entrenar el.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b4b4cb3d61aca36aeb0a2793d3087f63/078fe/img7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.64864864864865%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACuklEQVQozxWRWU9TCxSFz4MPxgcfNBocGFoK1LZ05JwGOgAFSalWOnHoKYWWQSiWSksKoobEKRK9XuODN/fHaYRSChESnC+UXvp5fNtr7b2zVvIJSlpGdFowmtrR6/XIsTHuLs7hHhBx9znok2Uml1fJFRaRPHZ6fE7sji7kSIL7xSX6/W4s5nZMZhOubhdCIHiTZrsZXft12jRX8Q8HiMRGaDLpkFwSE6koiaUi2UIGrVmPrq2Zbq+IPDbO9GwK24CLVpuJfrGDPklE8Hgl2oyNdHQZaWg4T2+vk9uh25w9dwaHu5fWTq3aVmJmbha9oQWvT+Ti9YsMBrpR0kla26/hG/YiiUZ0misIqWSKdGqc9NwMw/I4mWyWlZUi4WE/4XCAoXiczHKGF6/+pvD8GfO5NDdHguTWlnj6/CnKWJTJ6VECoTvEJuMIPw9+UP58QvkQSvsnqBKOjjj99R/V01NqtRPqqkW1Su3nL46qNarqvnp8DPVT6t++c1z7c1fj/3odIb+6xGw2zcLiNLOra2z88y8bb14iJyIkEzKJRIL5uQx/vXvD1L0pFu7PMLVcYP3de16/fU0wGiQm3yEai6DEFYT+Wz4MdhNdVh1DSRll5RGjcoQLOi0WFYxoNeKw2NXQu3SKFq40XcIdHCBcfISSVGhobKCxRYOm5TKapmaEkBzFar6Bx++izdRCeOwW4dEQTdrLOF02rBYDnZ0d3MvPY7hxDaunC4tkVKG4Wcgv4uyRMDlsGNRwnVaFMr/2kOlilsDIIA6Ph2x+gZVCjlhoiLDsx+YbJBgK8PjlBukHyygTI1jdPUxkp1h/sk4unyM1E0fyeej2eREOt0rsVvbY3Npku1Ti67cffNkps/PhI6VymcpOhf3DQ77u7bGvzju7u5S3t/mset8PDjj4tEmpUlF/tyhXdvkNCkDC5Y+GnicAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img7\"\n        title=\"img7\"\n        src=\"/static/b4b4cb3d61aca36aeb0a2793d3087f63/fcda8/img7.png\"\n        srcset=\"/static/b4b4cb3d61aca36aeb0a2793d3087f63/12f09/img7.png 148w,\n/static/b4b4cb3d61aca36aeb0a2793d3087f63/e4a3f/img7.png 295w,\n/static/b4b4cb3d61aca36aeb0a2793d3087f63/fcda8/img7.png 590w,\n/static/b4b4cb3d61aca36aeb0a2793d3087f63/efc66/img7.png 885w,\n/static/b4b4cb3d61aca36aeb0a2793d3087f63/078fe/img7.png 934w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Conversion de los bounds a annotation</h2>\n<p>Para entrenar el modelo, ademas de las imagenes <strong>necesitamos una forma de representar los bounds de los personajes</strong>, esto lo vamos a hacer con una función que convierte los bounds a un xml con el formato que necesitamos.</p>\n<p><div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token keyword\">from</span> json2xml <span class=\"token keyword\">import</span> json2xml\r\n<span class=\"token keyword\">def</span> <span class=\"token function\">bounding_box_to_annotation</span><span class=\"token punctuation\">(</span>bbox<span class=\"token punctuation\">,</span> img_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token triple-quoted-string string\">\"\"\"\r\n  Arma el xml para el bounding box de una forma rebuscada\r\n  \"\"\"</span>\r\n  data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token string\">\"annotation\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\r\n          <span class=\"token string\">\"folder\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"imgs\"</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"filename\"</span><span class=\"token punctuation\">:</span>img_name<span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"path\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"../imgs/\"</span><span class=\"token operator\">+</span>img_name<span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"source\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\r\n              <span class=\"token string\">\"database\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Unknown\"</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"size\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\r\n              <span class=\"token string\">\"width\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"height\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">250</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"depth\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"segmented\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n      <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">for</span> bounds<span class=\"token punctuation\">,</span> champ <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>bbox<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> bbox<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\r\n    data<span class=\"token punctuation\">[</span><span class=\"token string\">'annotation'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'object'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">:</span>champ<span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">\"pose\"</span><span class=\"token punctuation\">:</span><span class=\"token string\">\"Unspecified\"</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">\"truncated\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">\"difficult\"</span><span class=\"token punctuation\">:</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token string\">\"bndbox\"</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">{</span>\r\n          <span class=\"token string\">\"xmin\"</span><span class=\"token punctuation\">:</span>bounds<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"ymin\"</span><span class=\"token punctuation\">:</span>bounds<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"xmax\"</span><span class=\"token punctuation\">:</span>bounds<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token string\">\"ymax\"</span><span class=\"token punctuation\">:</span>bounds<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n\r\n  content <span class=\"token operator\">=</span> json2xml<span class=\"token punctuation\">.</span>Json2xml<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">,</span> root<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> attr_type<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> item_wrap<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>to_xml<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;object>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;/object>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;name>\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"&lt;object>&lt;name>\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;/bndbox>\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"&lt;/bndbox>&lt;/object>\"</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token keyword\">return</span> content\r\n\r</code></pre></div></p>\n<p>La idea es que cada vez que generemos una imagen, creemos un xml pasandole los bounds a esta funcion y luego lo guardamos en otra carpeta con el mismo nombre que la imagen.</p>\n<p>De esta forma obtenemos 2 carpetas, <strong>una con las imagenes y otra con los xmls</strong>, es muy importante que <strong>el nombre de las imagenes y los xmls sean iguales</strong> ya que esto permite a FastAI encontrar los xmls y imagenes correspondientes, solo debe cambiar la extensión.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 498px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fdf896ce69a8c60190986ba399e785fb/79e1b/img8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAk0lEQVQY03VPAQrCMAzs/z8mMsVXODsHK5O1i63paTZSKtaD0pC7XC4mpQS/LFhXgiDnjBakr+8fhDNi6KYJ8/xoDrdMWrxqDBHB+wD+NKQmeoKZNwFz3mr5ZaHwMca9V3jV8G547W84nS8IIWAYLO7jCEmtSVR4OHaw1sI5h5heP0mLoUatz6q3al0bfPNcLhK8Ad7Qibe2D/4mAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"img8\"\n        title=\"img8\"\n        src=\"/static/fdf896ce69a8c60190986ba399e785fb/79e1b/img8.png\"\n        srcset=\"/static/fdf896ce69a8c60190986ba399e785fb/12f09/img8.png 148w,\n/static/fdf896ce69a8c60190986ba399e785fb/e4a3f/img8.png 295w,\n/static/fdf896ce69a8c60190986ba399e785fb/79e1b/img8.png 498w\"\n        sizes=\"(max-width: 498px) 100vw, 498px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>Conclusion</h2>\n<p>En este punto podemos generar tantas imagenes como se quiera para entrenar el modelo, en la siguiente parte vamos a <strong>entrenar el modelo</strong> y verlo en accion.</p>","frontmatter":{"title":"Detección de personajes de LOL en tiempo real (Parte 1)","date":"July 12, 2022","description":"Parte 1 de la guía paso a paso de detección de personajes de LOL en minimapa","time":10}}},"pageContext":{"slug":"/lol-champ-minimap-detection-part-1/","previous":{"fields":{"slug":"/agro-algorithms/"},"frontmatter":{"title":"Algoritmos para agro","categories":["backend","algoritmos"]}},"next":null}},"staticQueryHashes":["3649515864","63159454"]}